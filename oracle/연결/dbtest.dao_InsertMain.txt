package dbtest.dao;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.Scanner;

public class InsertMain {
	private Connection conn;//conn여러 곳에서사용하니까
	private PreparedStatement pstmt;
	
	private String url = "jdbc:oracle:thin:@localhost:1521:xe"; //드라이버명
	private String username="c##java";
	private String password ="bit";
	
	public InsertMain() {
		//driver loading -db와 연결
		//OracleDriver.class => 파일명만 알고 있다 => 클래스? 인터페이스?
	
		try {     //forName-생성해주는 메서드
			Class.forName("oracle.jdbc.driver.OracleDriver");//"풀 쿼리 네임 적어야한다">패키지명
			System.out.println("driver loading success");
		} catch (ClassNotFoundException e) {
			e.printStackTrace();
		}
	
	}
	
	public void getConnection() {
		try {														 
			conn = DriverManager.getConnection(url, username, password);//커넥션 생성
			System.out.println("connection success");
		} catch (SQLException e) {
			e.printStackTrace();
		}
	}
	public void insertArticle() {
		//데이터
		Scanner scan = new Scanner(System.in);
		System.out.print("이름 입력 : ");
		String name= scan.next();
		System.out.print("나이 입력 : ");
		int age = scan.nextInt();
		System.out.print("키 입력 : ");
		double height = scan.nextDouble();
		//접속
		this.getConnection();
		
		//PreparedStatement pstmt = Connection 의 prepareStatement();통해서 생성
		try {
			 pstmt =conn.prepareStatement("insert into dbtest values(?,?,?,sysdate)");//prepare 생성//보안문제 데이터가 들어갈 자리에 ?
			 pstmt.setString(1, name);//oracle 은 1부터
			 pstmt.setInt(2,age);
			 pstmt.setDouble(3, height);
			int su= pstmt.executeUpdate();//실행 - 개수 리턴
			System.out.println(su + "개의 행 이(가) 삽입되엇습니다.");
			
		} catch (SQLException e) {
			e.printStackTrace();
		}finally {
			try {
				if(pstmt !=null)pstmt.close();// 앞에서 오류났을경우 종료시키면 오류나니까 확인후
				if(conn != null)conn.close();
			} catch (SQLException e) {
				e.printStackTrace();
			}
		}
		//insert into dbtest values('홍길동',25,185.3,sysdate);
	}

	public static void main(String[] args) {
		InsertMain insertMain = new InsertMain();
		insertMain.insertArticle();

	}

}
